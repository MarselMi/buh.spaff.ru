{% extends 'mainapp/base.html' %}
{% load static %}
{% block content %}

	<div class="row mb-4">
		<div class="col-12">
			<div class="card">
				<div class="card-body">
				{% if holders %}

					<div class="row">
						{% for count, holder in holders|enu_list %}
						<div class="col-lg-3 col-6 text-center mb-2">
							<div id="{{ holder.id }}" class="container-fluid holders_id" data-holder-name="{{ holder.organization_holder }}" style="border-radius: 15px; background: lightblue">
								<div class="inner" style="text-align: -webkit-center;border-radius: 20px;">
									<h1>
										{{ holder.holder_balance|numb_format }}
									</h1>
									<span data-bs-toggle="popover" data-bs-trigger="hover" data-bs-content="Нажмите для получения детальной информации">
										{{ holder.organization_holder }}
										<button type="button" class="btn btn-sm ms-1">
											<i class="fa-regular fa-info"></i>
										</button>
									</span>
									<p>
										Расчетный счет
										<span onclick="copyTextToClipboard( {{ holder.payment_account }} ); return false;" type="button" class="small ms-1" data-bs-toggle="tooltip" data-bs-title="Скопировать {{ holder.payment_account }}">
											<i class="fa-regular fa-clipboard"></i>
										</span>
									</p>
								</div>
								<!-- Button trigger modal -->
								<button type="button" class="btn buttonSelectModal" data-holder-id="{{ holder.id }}" data-bs-toggle="modal" data-bs-target="#exampleModal" data-bs-whatever="{{ holder.organization_holder }}">
									<div display="flex" class="Box-sc-1gh2r6s-0 CXccO" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-content="Добавить транзакцию">
										<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" style="display:inline-block;vertical-align:text-bottom">
											<path d="M14.513 6a.75.75 0 0 1 .75.75v2h1.987a.75.75 0 0 1 0 1.5h-1.987v2a.75.75 0 1 1-1.5 0v-2H11.75a.75.75 0 0 1 0-1.5h2.013v-2a.75.75 0 0 1 .75-.75Z">
											</path>
											<path d="M7.024 3.75c0-.966.784-1.75 1.75-1.75H20.25c.966 0 1.75.784 1.75 1.75v11.498a1.75 1.75 0 0 1-1.75 1.75H8.774a1.75 1.75 0 0 1-1.75-1.75Zm1.75-.25a.25.25 0 0 0-.25.25v11.498c0 .139.112.25.25.25H20.25a.25.25 0 0 0 .25-.25V3.75a.25.25 0 0 0-.25-.25Z">
											</path>
											<path d="M1.995 10.749a1.75 1.75 0 0 1 1.75-1.751H5.25a.75.75 0 1 1 0 1.5H3.745a.25.25 0 0 0-.25.25L3.5 20.25c0 .138.111.25.25.25h9.5a.25.25 0 0 0 .25-.25v-1.51a.75.75 0 1 1 1.5 0v1.51A1.75 1.75 0 0 1 13.25 22h-9.5A1.75 1.75 0 0 1 2 20.25l-.005-9.501Z">
											</path>
										</svg>
									</div>
								</button>
							</div>
						</div>
						{% endfor %}
					</div>

					<div class="row mb-4 mt-4 holderGraph">

						<div class="h2 text-center mainInformation">
							Общая информация по транзакциям
							<i class="fa-solid fa-circle-info text-info ms-1"
							   data-bs-toggle="popover" data-bs-trigger="hover focus"
							   data-bs-content="Для получения информации по отдельному балансодержателю нажмите на него">
							</i>
						</div>
						<div class="col-12 col-md-6 mainInformation">
							<div class="h3 text-center">Входящие транзакции - {{ all_coming|numb_format }}</div>
							<div id="ChartStatsPartIncome"></div>
						</div>

						<div class="col-12 col-md-6 mainInformation">
							<div class="h3 text-center">Исходящие транзакции - {{ all_expenditure|numb_format }}</div>
							<div id="ChartStatsPartExpenditure"></div>
						</div>

					</div>

					<div class="row mt-4">
						<div class="col-12 col-sm-12">
							<div class="card mb-4 card_info_trans">
								
								<!-- <div class="alert align-items-center mb-0 holder_alert text-center">
									<i class="fa-regular fa-triangle-exclamation me-2"></i>
									<div>
										<strong>Выберите балансодержателя для просмотра информации</strong>
									</div>
								</div> -->

								<div class="card-header card-header-no-bg border-bottom-0 holder_table" hidden>
									<div class="card-title h6 fw-bold text-uppercase border-start border-primary border-3 ps-2 mb-0">
										Транзакции
									</div> <!-- /card-title -->
								</div> <!-- /card-header -->

								<div class="card-body holder_table" hidden>
									
									<div class="table-responsive">
										<table class="table table-bordered text-nowrap mb-0">
											<thead>
												<tr class="text-center">
													<th>Дата создания</th>
													<th>Дата транзакции</th>
													<th>Дата изменения</th>
													<th>Тип транзакции</th>
													<th>Сумма</th>
													<th>Автор создания</th>
													<th>Балансодержатель</th>
													<th>Наименование</th>
													<th>Тип платежа</th>
													<th>Чек</th>
												</tr>
											</thead>
											
											<tbody class="info_transaction">
												
											</tbody>
											
										</table>
									</div> <!-- /table-responsive -->
									
								</div> <!-- /card-body -->

							</div> <!-- /card -->
						</div> <!-- /col -->
					</div> <!-- /row -->

				{% else %}

					<div class="table-responsive">
						<div class="alert alert-warning" role="alert">
							<h5 class="alert-heading text-center">
								<i class="fa-regular fa-octagon-exclamation me-2"></i>
								Для работы необходимо создать "Тип платежа", "Балансодержателя", "Транзакцию"
							</h5>
						</div>
					</div>

				{% endif %}
				</div> <!-- /card-body -->
			</div> <!-- /card -->
		</div> <!-- /col -->
	</div> <!--/row-->

	<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content border-0">
				<form class="needs-validation" action="" name="createNewTransaction" id="formSendTransaction" novalidate>
					<div class="modal-header">
						<h5 class="modal-title" id="newTransactionModalLabel">
							Новая транзакция для:
						</h5> <!-- /modal-title -->

						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div> <!-- /modal-header -->

					<div class="modal-body" id="formSendTransactionElem">
						<div class="form-floating mb-3">
							<input type="text" name="balance_holder" id="balance_holder" hidden/>

							<input class="form-control" type="text" id="newTransactionName" placeholder="Имя" name="newTransactionName" required/>
							<label for="newTransactionName">Имя транзакции</label>

						</div> <!-- /form-floating -->

						<div class="form-floating mb-3">
							<input class="form-control" autocomplete="off" onfocus="this.value=''" list="list_pay" name="type_payment" id="type_payment" placeholder="Тип платежа" required/>
							<datalist id="list_pay">
								{% for type in type_payments %}
								<option value="{{ type }}">{{ type }}</option>
								{% endfor %}
							</datalist>

							<label for="type_payment">
								Тип платежа
							</label>

							<div class="invalid-feedback">
								Пожалуйста, выберите корректный тип платежа
							</div>
						</div> <!-- /form-floating -->

						<div class="form-floating mb-3">
							<input class="form-control" autocomplete="off" onfocus="this.value=''" name="type_transaction" list="datalist_transaction_type" id="type_transaction" placeholder="Тип транзакции" required/>
							<datalist id="datalist_transaction_type">
								<option value="Приход">Приход</option>
								<option value="Расход">Расход</option>
							</datalist>

							<label for="type_transaction">
								Тип транзакции
							</label>

							<div class="invalid-feedback">
								Пожалуйста, выберите корректный тип транзакции
							</div>
						</div> <!-- /form-floating -->

						<div class="form-floating mb-3">
							<input class="form-control" autocomplete="off" name="transaction_date" placeholder="Нажмите сюда" id="datepicker" required/>
							<label for="datepicker">
								Дата транзакции
							</label>

							<div class="invalid-feedback">
								Пожалуйста, введите дату
							</div>
						</div> <!-- /form-floating -->

						<div class="form-floating mb-3">
							<input class="form-control" autocomplete="off" name="transaction_sum_post" placeholder="Сумма транзакции" id="transaction_sum_post" required/>
							<label for="transaction_sum_post">
								Сумма транзакции
							</label>

							<div class="invalid-feedback">
								Пожалуйста, введите правильную сумму транзакции
							</div>
						</div>  <!-- /form-floating -->

						<div class="form-floating mb-3">
							<input class="form-control" autocomplete="off" name="commission_post" placeholder="Сумма транзакции" value="0" id="commission_post" required/>
							<label for="commission_post">
								Сумма комиссии
							</label>

							<div class="invalid-feedback">
								Пожалуйста, введите правильную сумму транзакции
							</div>
						</div>  <!-- /form-floating -->
					</div> <!-- /modal-body -->

					<div class="modal-footer">
						<div class="row">
							<div class="col-12 mb-3">
								<button id="liveToastBtn" onclick="createTransaction()" type="submit" class="btn btn-primary w-100">
									Сохранить
								</button> <!-- /btn -->
							</div>
							<div class="col-12 mb-3">
								<a href="" class="btn btn-secondary w-100 holder_link">
									Перейти на полную версию создания
								</a> <!-- /btn -->
							</div>
						</div>
					</div> <!-- /modal-footer -->
				</form>
			</div> <!-- /modal-content -->
		</div> <!-- /modal-dialog -->
	</div> <!-- /modal -->

	<script>

		var profit_sum = {{ profit_coming|safe }};
		var label_comming = {{ label_coming|safe }};
		var option_comming = {
			series: profit_sum,
			labels: label_comming,
			chart: {
				type: 'donut',
			},
			legend: {
				show: true,
				position: 'top',
			},
			stroke: {
				width: 4,
				colors: ['#fff']
			},
			dataLabels: {
				style: {
					colors: ['#000000', '#000000', '#000000']
				},
				dropShadow: {
					enabled: true,
					top: 0,
					left: 0,
					blur: 1,
					color: '#ffffff',
					opacity: 70
				}
			}
		};

		if ($("#ChartStatsPartIncome")){
			var chart_comming = new ApexCharts(document.querySelector("#ChartStatsPartIncome"), option_comming);
			chart_comming.render();
		}

		var expenditure_sum = {{ profit_expenditure|safe }}
		var expenditure_label = {{ label_expenditure|safe }}
		var option_expenditure = {
			series: expenditure_sum,
			labels: expenditure_label,
			chart: {
				type: 'donut',
			},
			legend: {
				show: true,
				position: 'top',
			},
			stroke: {
				width: 4,
				colors: ['#fff']
			},
			dataLabels: {
				style: {
					colors: ['#000000', '#000000', '#000000']
				},
				dropShadow: {
					enabled: true,
					top: 0,
					left: 0,
					blur: 1,
					color: '#ffffff',
					opacity: 70
				}
			}
		}
		
		if ($("#ChartStatsPartExpenditure")){
			var chart_expenditure = new ApexCharts(document.querySelector("#ChartStatsPartExpenditure"), option_expenditure);
			chart_expenditure.render();
		}

	</script>

	<script>

		var url = document.location.href;
		var a = document.cookie.split(';');
		var token = ''

		for (i = 0; i < a.length; i++) {
			var b = a[i].split('=')
			b[0] = b[0].replace(/\s+/g, '')
			if (b[0] == 'csrftoken') {
			token = b[1]
			}
		}

		var exampleModal = document.getElementById('exampleModal')

		var regEx = /[\\><\|\/a-zA-Z\/\+~\=`\]!\[@\{#\}$%\^&:;*\?\(\)_\-а-яА-Я]/;

		$(function(){
			$("#datepicker").datepicker({dateFormat: 'dd.mm.yy'});
		});

		(function () {
			// Получите все формы, к которым мы хотим применить пользовательские стили проверки Bootstrap
			var forms = document.querySelectorAll('.needs-validation')
			var date_value = $('#datepicker').val();
			$('#transaction_sum_post').on('input', function(){
				if ($('#transaction_sum_post').val() && (!regEx.test($('#transaction_sum_post').val()))){
					$('#transaction_sum_post').removeClass('is-invalid');
					$('#transaction_sum_post').addClass('is-valid');
				}else{
					$('#transaction_sum_post').removeClass('is-valid');
					$('#transaction_sum_post').addClass('is-invalid');
					$('#liveToastBtn').removeAttr('data-bs-dismiss')
					$('#liveToastBtn').removeAttr('aria-label')
				}
			})
			$('#commission_post').on('input', function(){
				if ($('#commission_post').val() && (!regEx.test($('#commission_post').val()))){
					$('#commission_post').removeClass('is-invalid');
					$('#commission_post').addClass('is-valid');
				}else{
					$('#commission_post').removeClass('is-valid');
					$('#commission_post').addClass('is-invalid');
					$('#liveToastBtn').removeAttr('data-bs-dismiss')
					$('#liveToastBtn').removeAttr('aria-label')
				}
			})
			$('#type_payment').on('input change', function(){
				$.ajax(
					{
						url: url,
						method: 'POST',
						data: {
							csrfmiddlewaretoken: token,
							type: 'check_type',
							type_payment: $('#type_payment').val()
						}
					}).then(function(result) {
						if (result.message) {
							$('#type_payment').removeClass('is-invalid');
							$('#type_payment').addClass('is-valid');
						} else {
							$('#type_payment').removeClass('is-valid');
							$('#type_payment').addClass('is-invalid');
							$('#liveToastBtn').removeAttr('data-bs-dismiss')
							$('#liveToastBtn').removeAttr('aria-label')
						}
					}).catch(function(err) {
						var x = 1;
					}
				)
			})
			// Зацикливайтесь на них и предотвращайте отправку
			Array.prototype.slice.call(forms).forEach(function (form) {
				form.addEventListener('submit', function (event) {
					if ($('#transaction_sum_post').val() && (!regEx.test($('#transaction_sum_post').val()))) {
						event.preventDefault()
						event.stopPropagation()
					}else if ($('#commission_post').val() && (!regEx.test($('#commission_post').val()))) {
						event.preventDefault()
						event.stopPropagation()
					}else if (!((date_value.length == 10) && (!regEx.test($('#datepicker').val())))){
						event.preventDefault()
						event.stopPropagation()
					}else if (!(($('#type_transaction').val() == 'Приход') || ($('#type_transaction').val() == 'Расход'))){
						event.preventDefault()
						event.stopPropagation()
					}else if (!$('#type_payment').val()){
						$('#type_payment').removeClass('is-valid');
						$('#type_payment').addClass('is-invalid');
						event.preventDefault()
						event.stopPropagation()
					}else if (!form.checkValidity()) {
						event.preventDefault()
						event.stopPropagation()
					}
					form.classList.add('was-validated')
				}, false)
			})
		})()

		var buttonSelectModal = $('.buttonSelectModal')
		var modalTitle = exampleModal.querySelector('.modal-title')
		var holder_link = exampleModal.querySelector('.holder_link')

		for (let i=0;  buttonSelectModal.length > i; i++){
			buttonSelectModal[i].addEventListener('click', function(event){
				if (event.currentTarget == buttonSelectModal[i]){
					var holder = exampleModal.querySelector('#balance_holder')
					var id_holder = buttonSelectModal[i].getAttribute('data-holder-id')
					holder.value = buttonSelectModal[i].getAttribute('data-bs-whatever')
					modalTitle.textContent = 'Создать транзакцию для ' + buttonSelectModal[i].getAttribute('data-bs-whatever')
					holder_link.setAttribute('href', `transactions-holder-create/${id_holder}`)
				}
			})
		}

		function createTransaction(){

			var holder = exampleModal.querySelector('#balance_holder').value
			var transaction_name = exampleModal.querySelector('#newTransactionName').value
			var payment_type = exampleModal.querySelector('#type_payment').value
			var transaction_type = exampleModal.querySelector('#type_transaction').value
			var transaction_date = exampleModal.querySelector('#datepicker').value
			var transaction_sum = exampleModal.querySelector('#transaction_sum_post').value
			var commission = exampleModal.querySelector('#commission_post').value
			
			$.ajax(
			{
				url: url,
				method: 'POST',
				data: {
					csrfmiddlewaretoken: token,
					type: 'create_transaction',

					holder_post: holder,
					transaction_name_post: transaction_name,
					transaction_date_post: transaction_date,
					transaction_sum_post: transaction_sum,
					commission_post: commission,
					payment_type_post: payment_type,
					transaction_type_post: transaction_type
				}
			}).then(function(result) {
				console.log('OK');
				location.reload();
				var x = 1;
			}).catch(function(err) {
				console.log('ERR')
				var x = 2;
			})
		}

		var holders_id = document.querySelectorAll('.holders_id');

		for (let i=0; i < holders_id.length; i++){
			holders_id[i].addEventListener('click', function(event) {
				if (event.currentTarget == holders_id[i]){
				$.ajax({
					url: url,
					method: 'POST',
					data: {
						csrfmiddlewaretoken: token,
						type: 'holder',
						id: holders_id[i].getAttribute("id")
					}
				}).then(function(result){

					function add(accumulator, a) {
						return accumulator + a;
					}

					var graphElement = $('.holderGraph');
					var result_el = JSON.parse(result);

					var holder_label_coming = result_el.holder_label_coming;
					var holder_profit_coming = result_el.holder_profit_coming;
					var holder_label_expenditure = result_el.holder_label_expenditure;
					var holder_profit_expenditure = result_el.holder_profit_expenditure;

					var option__holder_comming = {
						series: holder_profit_coming,
						labels: holder_label_coming,
						chart: {
							type: 'donut',
						},
						legend: {
							show: true,
							position: 'top',
						},
						stroke: {
							width: 4,
							colors: ['#fff']
						},
						dataLabels: {
							style: {
								colors: ['#000000', '#000000', '#000000']
							},
							dropShadow: {
								enabled: true,
								top: 0,
								left: 0,
								blur: 1,
								color: '#ffffff',
								opacity: 70
							}
						}
					};

					var option__holder_expend = {
						series: holder_profit_expenditure,
						labels: holder_label_expenditure,
						chart: {
							type: 'donut',
						},
						legend: {
							show: true,
							position: 'top',
						},
						stroke: {
							width: 4,
							colors: ['#fff']
						},
						dataLabels: {
							style: {
								colors: ['#000000', '#000000', '#000000']
							},
							dropShadow: {
								enabled: true,
								top: 0,
								left: 0,
								blur: 1,
								color: '#ffffff',
								opacity: 70
							}
						}
					};

					graphElement.empty();

					var informationTable = `
						<div class="h2 text-center">
							Общая информация по балансодержателю - ${holders_id[i].getAttribute('data-holder-name')}
						</div>`;
					
					var incom = `
						<div class="col-12 col-md-6 mainInformation">
							<div class="h3 text-center">Нет данных</div>
						</div>`
					if (holder_profit_coming.length){
						let sumComming = holder_profit_coming.reduce(add, 0);

						var incom = `
							<div class="col-12 col-md-6 mainInformation">
								<div class="h3 text-center">Входящие транзакции - ${sumComming}</div>
								<div id="ChartStatsPartIncomeHolder"></div>
							</div>`
					}

					var expend = `
						<div class="col-12 col-md-6 mainInformation">
							<div class="h3 text-center">Нет данных</div>
						</div>`
					if (holder_profit_expenditure.length){
						let sumEpend = holder_profit_expenditure.reduce(add, 0);
						var expend = `
							<div class="col-12 col-md-6 mainInformation">
								<div class="h3 text-center">Исходящие транзакции - ${sumEpend}</div>
								<div id="ChartStatsPartExpenditureHolder"></div>
							</div>`
					}
					
					graphElement.prepend(informationTable, incom, expend);

					var chart_comming_holder = new ApexCharts(document.querySelector("#ChartStatsPartIncomeHolder"), option__holder_comming);						
					chart_comming_holder.render();

					var chart_exp_holder = new ApexCharts(document.querySelector("#ChartStatsPartExpenditureHolder"), option__holder_expend);
					chart_exp_holder.render();

				}).catch(function(err){
					var x = 1
				})}
				}
			)
		}

		// for (let i = 0; i < holders_id.length; i++){
			
		// 	holders_id[i].addEventListener('click', function(event) {
		// 		if (event.currentTarget == holders_id[i]){
		// 			holders_id[i].classList.add('border-dark');
		// 			$.ajax(
		// 				{
		// 					url: url,
		// 					method: 'POST',
		// 					data: {
		// 						csrfmiddlewaretoken: token,
		// 						type: 'holders_id',
		// 						id: holders_id[i].getAttribute("id")
		// 					}
		// 				}).then(function(result) {
		// 					var transaction_table = $('.info_transaction');
		// 					$('.holder_alert').remove();
		// 					$('.sum_transaction_info').remove();
		// 					transaction_table.empty();

		// 					var response = JSON.parse(result);
		// 					var transa = response.transactions;
		// 					var sum_coming = response.sum_coming;
		// 					var sum_expenditure = response.sum_expenditure;
		// 					var balance_holder = response.balance_holder
							
		// 					if (transa.length) {
		// 						if ($('.sum_transaction_info')){
		// 							$('.sum_transaction_info').remove();
		// 						}
		// 						var sum_transaction_info = `<div class="row sum_transaction_info">
		// 														<div class="text-center">
		// 															<strong>Балансодержатель - ${balance_holder}</strong>
		// 															</div>
		// 														<div class="row">
		// 															<div class="col-lg-3 col-6 container-fluid ">
		// 																<div class="pt-4 pb-3">
		// 																	<div class="d-flex">
		// 																		<div class="h6 mb-2 small">
		// 																			<strong>Сумма входящих транзакция</strong>
		// 																		</div>
		// 																	</div>
		// 																	<div class="pb-0 mt-0">
		// 																		<div class="d-flex">
		// 																			<div class="fs-5 fw-light mb-0">
		// 																				${sum_coming.coming} <i class="fa-regular fa-ruble-sign ms-1"></i>
		// 																			</div>
		// 																		</div>
		// 																	</div>
		// 																</div>
		// 															</div> <!-- /col -->

		// 															<div class="col-lg-3 col-6 container-fluid ">
		// 																<div class="pt-4 pb-3">
		// 																	<div class="d-flex">
		// 																		<div class="h6 mb-2 small">
		// 																			<strong>Сумма исходящих транзакция</strong>
		// 																		</div>
		// 																	</div>
		// 																	<div class="pb-0 mt-0">
		// 																		<div class="d-flex">
		// 																			<div class="fs-5 fw-light mb-0">
		// 																				${sum_expenditure.expenditure} <i class="fa-regular fa-ruble-sign ms-1"></i>
		// 																			</div>
		// 																		</div>
		// 																	</div>
		// 																</div> <!-- /col -->
		// 															</div> <!-- /col -->
		// 														</div> <!-- /row -->
		// 													</div> <!-- /row -->`
		// 						$('.holder_non_transaction').remove()
		// 						$('.holder_table').removeAttr('hidden');
								
		// 						$('.card_info_trans').prepend(sum_transaction_info);
		// 						for (let i = 0; i < transa.length; i++) {
		// 							if (transa[i].type_transaction == 'COMING') {
		// 								var type = `<span class="badge text-bg-outline-success d-flex align-items-center justify-content-center rounded-pill">
		// 												Приход
		// 											</span>`
		// 							} else {
		// 								var type = `<span class="badge text-bg-outline-danger d-flex align-items-center justify-content-center rounded-pill">
		// 												Расход
		// 											</span>`
		// 							};

		// 							if (transa[i].check_img) {
		// 								var img = `<a href="/media/${transa[i].check_img}" data-bs-toggle="tooltip" data-bs-title="Посмотреть">
		// 												<i class="fa-regular fa-clipboard"></i>
		// 											</a>`
		// 							} else {
		// 								var img = '&ndash;'
		// 							}

		// 							if (transa[i].update_date){
		// 								var update_date = transa[i].update_date
		// 							} else {
		// 								var update_date = '&ndash;'
		// 							}

		// 							var transaction_info =`<tr class="text-center">
		// 														<td>${transa[i].create_date}</td>
		// 														<td>${transa[i].transaction_date}</td>
		// 														<td>${update_date}</td>
		// 														<td>${type}</td>
		// 														<td>${transa[i].amount}</td>
		// 														<td>${transa[i].author_id}</td>
		// 														<td>${transa[i].balance_holder_id}</td>
		// 														<td>${transa[i].name}</td>
		// 														<td>${transa[i].type_payment_id}</td>
		// 														<td>${img}</td>
		// 													</tr>`;
		// 							transaction_table.prepend(transaction_info);
		// 						}
		// 					} else {
		// 						var no_transactions = `<div class="alert d-flex align-items-center mb-0 holder_non_transaction">
		// 													<i class="fa-regular fa-triangle-exclamation me-2"></i>
		// 													<div>
		// 														У Балансодержателя отсутствуют завершенные транзакции
		// 													</div>
		// 												</div>`
		// 						if ($('.holder_non_transaction')){
		// 							$('.holder_non_transaction').remove();
		// 						}
		// 						$('.holder_table').attr('hidden', 'true');
		// 						$('.card_info_trans').prepend(no_transactions);
		// 					}
		// 				}).catch(function(err) {
		// 					var x = 1;
		// 			})
		// 		} else {
		// 			holders_id[i].classList.remove('border-dark');
		// 		}
		// 	})
		// };

	</script>

{% endblock content %}
